{% extends "base.html" %}
{% load static %}

{% block title %}Browse Songs - Music Player{% endblock %}

{% block content %}
    <h1>Browse All Songs</h1>

    {% if all_songs %}
        <ul class="item-list browse-songs-list">
            {% for song in all_songs %}
                <li>
                    <span class="item-info">
                         <span class="item-title">{{ song.title }}</span>
                         <span class="item-artist">{% for artist in song.artists.all %}{{ artist.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</span>
                    </span>
                    <div class="actions">
                        {% if song.file %}
                            <button type="button" class="action-button play-button"
                                    data-song-url="{{ song.file.url }}"
                                    data-song-title="{{ song.title }}"
                                    data-song-artist="{% for artist in song.artists.all %}{{ artist.name }}{% if not forloop.last %}, {% endif %}{% endfor %}"
                                    data-song-cover="{% with release=song.get_release %}{% if release.cover_image %}{{ release.cover_image.url }}{% elif release.cover_image_url %}{{ release.cover_image_url }}{% else %}{% static 'placeholder-cover.png' %}{% endif %}{% endwith %}"
                                    data-song-id="{{ song.id }}">
                                Play
                            </button>
                            <button type="button" class="action-button add-queue-button" data-song-id="{{ song.id }}">
                                <i class="fa-solid fa-list-ul"></i>
                            </button>
                        {% else %}
                            <span class="file-missing">(File missing)</span>
                        {% endif %}
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No songs found in the database yet.</p>
    {% endif %}

    <div class="back-link">
        {# Update link for AJAX #}
        <a href="{% url 'home' %}" class="ajax-link" data-target-url="{% url 'home' %}">Back to Home</a>
    </div>
{% endblock %}